<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Couvertures pour Aldo</title>
    <meta name="description" content="Application pour déterminer la couverture adaptée à votre cheval selon la température">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Netflix+Sans:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --netflix-red: #E50914;
            --netflix-red-dark: #B20710;
            --netflix-black: #141414;
            --netflix-dark-gray: #2D2D2D;
            --netflix-gray: #404040;
            --netflix-light-gray: #8C8C8C;
            --netflix-white: #FFFFFF;
            --netflix-gradient: linear-gradient(135deg, #E50914 0%, #B20710 100%);
            --netflix-gradient-dark: linear-gradient(135deg, #141414 0%, #2D2D2D 100%);
            --netflix-gradient-card: linear-gradient(135deg, #1A1A1A 0%, #2D2D2D 100%);
            --shadow-netflix: 0 8px 30px rgba(0, 0, 0, 0.6);
            --shadow-netflix-sm: 0 4px 20px rgba(0, 0, 0, 0.4);
            --border-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        /* Reset et styles de base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Netflix Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--netflix-black);
            color: var(--netflix-white);
            line-height: 1.4;
            min-height: 100vh;
            padding: 0;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 16px;
        }

        /* En-tête style Netflix - Mobile First */
        header {
            background: var(--netflix-gradient-dark);
            color: var(--netflix-white);
            padding: 1.5rem 0;
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
            border-bottom: 3px solid var(--netflix-red);
            box-shadow: var(--shadow-netflix);
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--netflix-gradient);
        }

        h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            letter-spacing: -0.5px;
            flex-wrap: wrap;
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin-top: 0.8rem;
            font-weight: 400;
            color: var(--netflix-light-gray);
            padding: 0 10px;
        }

        .settings-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(229, 9, 20, 0.9);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1.1rem;
            box-shadow: var(--shadow-netflix-sm);
            z-index: 100;
        }

        .settings-btn:hover,
        .settings-btn:focus {
            background: var(--netflix-red);
            transform: rotate(90deg) scale(1.1);
            outline: none;
            box-shadow: 0 6px 25px rgba(229, 9, 20, 0.5);
        }

        /* Section principale - Layout mobile */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            align-items: stretch;
        }

        /* Section de saisie style carte Netflix */
        .input-section {
            background: var(--netflix-gradient-card);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-netflix);
            transition: var(--transition);
            border: 1px solid var(--netflix-gray);
            position: relative;
            overflow: hidden;
        }

        .input-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--netflix-gradient);
        }

        .input-section:active {
            transform: scale(0.98);
        }

        .form-group {
            margin-bottom: 2rem;
        }

        label {
            display: block;
            margin-bottom: 1rem;
            font-weight: 700;
            color: var(--netflix-white);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .input-with-icon {
            position: relative;
        }

        .input-with-icon i {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--netflix-red);
            z-index: 1;
            font-size: 1.2rem;
        }

        input[type="number"], 
        input[type="text"] {
            width: 100%;
            padding: 18px 18px 18px 50px;
            border: 2px solid var(--netflix-gray);
            border-radius: 8px;
            font-size: 1.1rem;
            background: var(--netflix-dark-gray);
            color: var(--netflix-white);
            -webkit-appearance: none;
            -moz-appearance: textfield;
            transition: var(--transition);
            font-weight: 500;
            font-family: 'Netflix Sans', sans-serif;
            min-height: 60px;
        }

        /* Amélioration pour mobile - taille de touche minimale */
        input[type="number"]:focus, 
        input[type="text"]:focus {
            outline: none;
            border-color: var(--netflix-red);
            background: var(--netflix-black);
            box-shadow: 0 0 0 3px rgba(229, 9, 20, 0.3);
        }

        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 1rem;
        }

        .radio-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 16px;
            border: 2px solid var(--netflix-gray);
            border-radius: 8px;
            background: var(--netflix-dark-gray);
            font-size: 1rem;
            transition: var(--transition);
            font-weight: 500;
            min-height: 60px;
        }

        .radio-option:active {
            transform: scale(0.98);
        }

        .radio-option input {
            margin-right: 12px;
            transform: scale(1.3);
            accent-color: var(--netflix-red);
        }

        .radio-option.selected {
            border-color: var(--netflix-red);
            background: rgba(229, 9, 20, 0.1);
            box-shadow: 0 8px 25px rgba(229, 9, 20, 0.2);
        }

        /* Boutons style Netflix - Taille mobile optimale */
        .btn {
            background: var(--netflix-gradient);
            color: white;
            border: none;
            padding: 18px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin: 16px 0;
            box-shadow: var(--shadow-netflix-sm);
            min-height: 60px;
            text-decoration: none;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            font-family: 'Netflix Sans', sans-serif;
            -webkit-user-select: none;
            user-select: none;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn:hover,
        .btn:focus {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(229, 9, 20, 0.4);
            outline: none;
        }

        .btn-meteo {
            background: linear-gradient(135deg, #00A8FF 0%, #0097E6 100%);
        }

        .btn-meteo:hover {
            box-shadow: 0 10px 30px rgba(0, 168, 255, 0.4);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--netflix-red);
            color: var(--netflix-red);
        }

        .btn-outline:hover,
        .btn-outline:focus {
            background: var(--netflix-red);
            color: white;
            transform: translateY(-2px);
        }

        .btn-settings {
            background: linear-gradient(135deg, #8E44AD 0%, #9B59B6 100%);
        }

        /* Section météo */
        .meteo-section {
            background: rgba(0, 168, 255, 0.1);
            border: 2px solid rgba(0, 168, 255, 0.3);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin: 2rem 0;
            text-align: center;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .meteo-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(135deg, #00A8FF 0%, #0097E6 100%);
        }

        .meteo-section:active {
            transform: scale(0.98);
        }

        .meteo-title {
            font-weight: 700;
            color: #00A8FF;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .meteo-description {
            color: var(--netflix-light-gray);
            font-size: 1rem;
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }

        /* Section Historique style Netflix */
        .history-section {
            background: var(--netflix-gradient-card);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-netflix);
            transition: var(--transition);
            border: 1px solid var(--netflix-gray);
            position: relative;
            overflow: hidden;
        }

        .history-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(135deg, #8E44AD 0%, #9B59B6 100%);
        }

        .history-section:active {
            transform: scale(0.98);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .history-title {
            font-weight: 900;
            color: var(--netflix-white);
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .history-actions {
            display: flex;
            gap: 10px;
        }

        .history-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--netflix-gray);
            color: var(--netflix-white);
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: var(--transition);
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            -webkit-user-select: none;
            user-select: none;
        }

        .history-btn:active {
            transform: scale(0.9);
        }

        .history-btn:hover {
            background: var(--netflix-red);
            color: white;
            transform: scale(1.05);
            border-color: var(--netflix-red);
        }

        .history-list {
            max-height: 300px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--netflix-red) var(--netflix-dark-gray);
            -webkit-overflow-scrolling: touch;
        }

        .history-list::-webkit-scrollbar {
            width: 6px;
        }

        .history-list::-webkit-scrollbar-track {
            background: var(--netflix-dark-gray);
            border-radius: 4px;
        }

        .history-list::-webkit-scrollbar-thumb {
            background: var(--netflix-red);
            border-radius: 4px;
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid var(--netflix-gray);
            transition: var(--transition);
            border-radius: 6px;
            margin-bottom: 8px;
            background: rgba(255, 255, 255, 0.03);
            min-height: 70px;
        }

        .history-item:active {
            transform: scale(0.98);
        }

        .history-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .history-date {
            font-weight: 700;
            color: var(--netflix-red);
            min-width: 80px;
            font-size: 0.9rem;
        }

        .history-temp {
            font-size: 1.4rem;
            font-weight: 900;
            min-width: 60px;
            text-align: center;
            background: linear-gradient(135deg, #E50914, #00A8FF, #8E44AD);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .history-rec {
            flex-grow: 1;
            margin: 0 1rem;
            font-weight: 600;
            font-size: 1rem;
        }

        .history-delete {
            background: rgba(229, 9, 20, 0.1);
            border: 2px solid rgba(229, 9, 20, 0.3);
            color: var(--netflix-red);
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-user-select: none;
            user-select: none;
        }

        .history-delete:active {
            transform: scale(0.9);
        }

        .history-delete:hover {
            background: var(--netflix-red);
            color: white;
            transform: scale(1.05);
            border-color: var(--netflix-red);
        }

        .empty-history {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--netflix-light-gray);
        }

        .empty-history i {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            opacity: 0.5;
            background: linear-gradient(135deg, #E50914, #8E44AD);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        /* Modales style Netflix - Optimisées mobile */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            padding: 16px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--netflix-gradient-card);
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-netflix);
            transform: translateY(30px) scale(0.95);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            border: 1px solid var(--netflix-gray);
        }

        .modal-overlay.active .modal {
            transform: translateY(0) scale(1);
        }

        .modal-header {
            padding: 1.5rem;
            background: var(--netflix-gradient);
            color: white;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            min-height: 80px;
        }

        .modal-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--netflix-gradient);
        }

        .modal-title {
            font-size: 1.4rem;
            font-weight: 900;
            display: flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            flex-wrap: wrap;
        }

        .close-modal {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
            flex-shrink: 0;
            -webkit-user-select: none;
            user-select: none;
        }

        .close-modal:active {
            transform: scale(0.9);
        }

        .close-modal:hover,
        .close-modal:focus {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg) scale(1.05);
            outline: none;
        }

        .modal-body {
            padding: 1.5rem;
        }

        /* Formulaire de paramètres */
        .settings-form {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .settings-group {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .settings-label {
            font-weight: 700;
            color: var(--netflix-white);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        /* Affichage des résultats - Optimisé mobile */
        .temperature-display {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #E50914, #00A8FF, #8E44AD, #00D2D3);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            animation: netflixPulse 2s infinite;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        @keyframes netflixPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }

        .recommendation {
            font-size: 1.6rem;
            margin-bottom: 1.5rem;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            flex-wrap: wrap;
        }

        .details {
            color: var(--netflix-light-gray);
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
            line-height: 1.5;
            text-align: center;
            padding: 0 10px;
        }

        .info {
            color: var(--netflix-white);
            font-weight: 600;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: inline-block;
            font-size: 1rem;
            border: 1px solid var(--netflix-gray);
            text-align: center;
            margin: 0 auto;
            display: block;
            width: fit-content;
            max-width: 100%;
        }

        /* Guide - Optimisé mobile */
        .guide-grid {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            text-align: left;
        }

        .guide-card {
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow-netflix);
            transition: var(--transition);
            background: var(--netflix-gradient-card);
            border: 1px solid var(--netflix-gray);
        }

        .guide-card:active {
            transform: scale(0.98);
        }

        .guide-header {
            background: var(--netflix-gradient);
            color: white;
            padding: 1.5rem;
            font-weight: 900;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            min-height: 80px;
        }

        .guide-body {
            padding: 1.5rem;
        }

        .temperature-range {
            display: flex;
            justify-content: space-between;
            padding: 1rem 0;
            border-bottom: 1px solid var(--netflix-gray);
            transition: var(--transition);
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
        }

        .temperature-range:active {
            transform: scale(0.98);
        }

        .temperature-range:last-child {
            border-bottom: none;
        }

        .range {
            font-weight: 700;
            color: var(--netflix-red);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
            min-width: 140px;
        }

        .recommendation-text {
            color: var(--netflix-white);
            font-weight: 600;
            font-size: 1rem;
            text-align: right;
            flex: 1;
            min-width: 150px;
        }

        /* Classes de couleur pour les recommandations */
        .no-blanket { 
            color: #00D2D3;
            font-weight: 900;
        }
        .light-blanket { 
            color: #00A8FF;
            font-weight: 700;
        }
        .medium-blanket { 
            color: #8E44AD;
            font-weight: 700;
        }
        .heavy-blanket { 
            color: #E50914;
            font-weight: 700;
        }

        /* Indicateur d'état de tonte */
        .tonte-indicator {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 700;
            margin-left: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            text-transform: uppercase;
            letter-spacing: 0.3px;
            flex-shrink: 0;
        }

        .tonte-indicator.tondu {
            background: rgba(0, 210, 211, 0.2);
            color: #00D2D3;
        }

        .tonte-indicator.non-tondu {
            background: rgba(142, 68, 173, 0.2);
            color: #8E44AD;
        }

        /* Message d'erreur */
        .error-message {
            color: var(--netflix-red);
            font-size: 1rem;
            margin-top: 0.8rem;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }

        /* Pied de page */
        footer {
            text-align: center;
            padding: 2rem 0;
            color: var(--netflix-light-gray);
            font-size: 1rem;
            margin-top: 3rem;
            border-top: 1px solid var(--netflix-gray);
        }

        /* ===== RESPONSIVE DESIGN ===== */

        /* Tablettes (768px et plus) */
        @media (min-width: 768px) {
            .container {
                padding: 0 24px;
            }

            header {
                padding: 2rem 0;
                margin-bottom: 3rem;
            }

            h1 {
                font-size: 2.5rem;
                gap: 15px;
            }

            .subtitle {
                font-size: 1.2rem;
            }

            .settings-btn {
                top: 2rem;
                right: 2rem;
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }

            .main-content {
                display: grid;
                grid-template-columns: 1fr 400px;
                gap: 2.5rem;
                align-items: start;
            }

            .input-section {
                padding: 2rem;
            }

            .history-section {
                padding: 2rem;
            }

            .radio-group {
                flex-direction: row;
            }

            .radio-option {
                min-width: 140px;
            }

            .temperature-display {
                font-size: 4.5rem;
            }

            .recommendation {
                font-size: 2rem;
            }

            .guide-grid {
                flex-direction: row;
            }

            .guide-card {
                flex: 1;
            }
        }

        /* Desktop (1024px et plus) */
        @media (min-width: 1024px) {
            h1 {
                font-size: 3rem;
            }

            .input-section:hover {
                transform: translateY(-5px);
            }

            .history-section:hover {
                transform: translateY(-5px);
            }

            .guide-card:hover {
                transform: translateY(-8px);
            }

            .history-item:hover {
                transform: translateX(5px);
            }

            .temperature-range:hover {
                transform: translateX(5px);
            }
        }

        /* Grands écrans (1200px et plus) */
        @media (min-width: 1200px) {
            .container {
                padding: 0 32px;
            }

            .main-content {
                gap: 3rem;
            }
        }

        /* Orientation paysage sur mobile */
        @media (max-height: 500px) and (orientation: landscape) {
            header {
                padding: 1rem 0;
                margin-bottom: 1.5rem;
            }

            .input-section,
            .history-section {
                padding: 1rem;
            }

            .modal {
                max-height: 80vh;
            }

            .history-list {
                max-height: 200px;
            }
        }

        /* Support pour les appareils avec notch */
        @supports (padding: max(0px)) {
            .container {
                padding-left: max(16px, env(safe-area-inset-left));
                padding-right: max(16px, env(safe-area-inset-right));
            }
            
            header {
                padding-top: max(1.5rem, env(safe-area-inset-top));
            }
            
            footer {
                padding-bottom: max(2rem, env(safe-area-inset-bottom));
            }
        }

        /* Amélioration de l'accessibilité */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Prévention du zoom sur iOS pour les inputs */
        @media screen and (max-width: 768px) {
            input[type="number"],
            input[type="text"],
            select {
                font-size: 16px; /* Empêche le zoom automatique sur iOS */
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1><i class="fas fa-horse" aria-hidden="true"></i> COUVERTURES POUR <span id="horse-name">ALDO</span></h1>
            <p class="subtitle">Pour <span id="owner-name">Stéphanie</span> – Propriétaire attentionnée</p>
            <button class="settings-btn" id="open-settings" aria-label="Ouvrir les paramètres">
                <i class="fas fa-cog" aria-hidden="true"></i>
            </button>
        </div>
    </header>

    <main class="container">
        <div class="main-content">
            <div class="input-section">
                <div class="form-group">
                    <label for="temperature"><i class="fas fa-thermometer-half" aria-hidden="true"></i> TEMPÉRATURE MINIMALE NOCTURNE (°C)</label>
                    <div class="input-with-icon">
                        <i class="fas fa-temperature-low" aria-hidden="true"></i>
                        <input type="number" id="temperature" placeholder="Ex: 5" min="-20" max="30" step="0.1" inputmode="decimal" aria-describedby="temperature-help">
                    </div>
                    <div id="temperature-help" class="error-message" style="display: none;">
                        <i class="fas fa-exclamation-circle"></i> Veuillez entrer une température valide entre -20°C et 30°C
                    </div>
                </div>

                <div class="meteo-section">
                    <div class="meteo-title">
                        <i class="fas fa-cloud-sun" aria-hidden="true"></i> VÉRIFIER LA MÉTÉO
                    </div>
                    <div class="meteo-description">
                        Consultez la température minimale nocturne sur Météo-France pour obtenir la recommandation adaptée.
                    </div>
                    <a href="https://meteofrance.com/previsions-meteo-france/aix-les-bains/73100" target="_blank" rel="noopener" class="btn btn-meteo">
                        <i class="fas fa-external-link-alt" aria-hidden="true"></i> OUVRIR MÉTÉO-FRANCE
                    </a>
                </div>

                <button id="open-guide" class="btn btn-outline">
                    <i class="fas fa-book" aria-hidden="true"></i> AFFICHER LE GUIDE DES COUVERTURES
                </button>
            </div>

            <!-- Section Historique -->
            <div class="history-section">
                <div class="history-header">
                    <div class="history-title">
                        <i class="fas fa-history"></i> HISTORIQUE
                    </div>
                    <div class="history-actions">
                        <button class="history-btn" id="clear-history" title="Effacer l'historique">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                        <button class="history-btn" id="toggle-history" title="Réduire/Agrandir">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                </div>
                <div class="history-list" id="history-list">
                    <!-- Rempli dynamiquement -->
                </div>
            </div>
        </div>
    </main>

    <!-- Popup Résultat -->
    <div id="result-modal" class="modal-overlay" aria-hidden="true" role="dialog" aria-labelledby="result-title">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-horse" aria-hidden="true"></i> 
                    <span id="result-title">RECOMMANDATION POUR <span id="horse-name-3">ALDO</span></span>
                    <span id="tonte-indicator-modal" class="tonte-indicator tondu">
                        <i class="fas fa-cut" aria-hidden="true"></i> TONDU
                    </span>
                </div>
                <button class="close-modal" id="close-result" aria-label="Fermer">&times;</button>
            </div>
            <div class="modal-body" id="result-modal-body">
                <!-- Rempli dynamiquement -->
            </div>
        </div>
    </div>

    <!-- Popup Guide -->
    <div id="guide-modal" class="modal-overlay" aria-hidden="true" role="dialog" aria-labelledby="guide-title">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="guide-title"><i class="fas fa-book-open" aria-hidden="true"></i> GUIDE DES COUVERTURES</div>
                <button class="close-modal" id="close-guide" aria-label="Fermer">&times;</button>
            </div>
            <div class="modal-body">
                <div class="guide-grid">
                    <div class="guide-card">
                        <div class="guide-header">
                            <i class="fas fa-snowflake" aria-hidden="true"></i> <span id="horse-name-4">ALDO</span> EST TONDU
                        </div>
                        <div class="guide-body">
                            <div class="temperature-range">
                                <span class="range"><i class="fas fa-temperature-high" aria-hidden="true"></i> 10° à 15°</span>
                                <span class="recommendation-text light-blanket">Chemise d'écurie</span>
                            </div>
                            <div class="temperature-range">
                                <span class="range"><i class="fas fa-temperature-high" aria-hidden="true"></i> 5° à 10°</span>
                                <span class="recommendation-text light-blanket">Polaire ou couverture (100–150 gr)</span>
                            </div>
                            <div class="temperature-range">
                                <span class="range"><i class="fas fa-temperature-low" aria-hidden="true"></i> 0° à 5°</span>
                                <span class="recommendation-text medium-blanket">Couverture mi-saison (200 gr)</span>
                            </div>
                            <div class="temperature-range">
                                <span class="range"><i class="fas fa-temperature-low" aria-hidden="true"></i> -5° à 0°</span>
                                <span class="recommendation-text heavy-blanket">Couverture chaude (300 gr)</span>
                            </div>
                            <div class="temperature-range">
                                <span class="range"><i class="fas fa-temperature-low" aria-hidden="true"></i> -10° à -5°</span>
                                <span class="recommendation-text heavy-blanket">Couverture épaisse (400 gr)</span>
                            </div>
                        </div>
                    </div>
                    <div class="guide-card">
                        <div class="guide-header">
                            <i class="fas fa-wind" aria-hidden="true"></i> <span id="horse-name-5">ALDO</span> N'EST PAS TONDU
                        </div>
                        <div class="guide-body">
                            <div class="temperature-range">
                                <span class="range"><i class="fas fa-temperature-high" aria-hidden="true"></i> 10° à 15°</span>
                                <span class="recommendation-text no-blanket">Pas de couverture</span>
                            </div>
                            <div class="temperature-range">
                                <span class="range"><i class="fas fa-temperature-high" aria-hidden="true"></i> 5° à 10°</span>
                                <span class="recommendation-text light-blanket">Polaire ou couverture</span>
                            </div>
                            <div class="temperature-range">
                                <span class="range"><i class="fas fa-temperature-low" aria-hidden="true"></i> 0° à 5°</span>
                                <span class="recommendation-text light-blanket">Polaire (100 gr)</span>
                            </div>
                            <div class="temperature-range">
                                <span class="range"><i class="fas fa-temperature-low" aria-hidden="true"></i> -5° à 0°</span>
                                <span class="recommendation-text medium-blanket">Couverture mi-saison (200 gr)</span>
                            </div>
                            <div class="temperature-range">
                                <span class="range"><i class="fas fa-temperature-low" aria-hidden="true"></i> -10° à -5°</span>
                                <span class="recommendation-text heavy-blanket">Couverture épaisse (300 gr)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Popup Paramètres -->
    <div id="settings-modal" class="modal-overlay" aria-hidden="true" role="dialog" aria-labelledby="settings-title">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="settings-title"><i class="fas fa-cog" aria-hidden="true"></i> PARAMÈTRES</div>
                <button class="close-modal" id="close-settings" aria-label="Fermer">&times;</button>
            </div>
            <div class="modal-body">
                <form class="settings-form" id="settings-form">
                    <div class="settings-group">
                        <label class="settings-label" for="settings-horse-name">
                            <i class="fas fa-horse" aria-hidden="true"></i> NOM DU CHEVAL
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-pencil-alt" aria-hidden="true"></i>
                            <input type="text" id="settings-horse-name" placeholder="Ex: Aldo" value="Aldo">
                        </div>
                    </div>
                    
                    <div class="settings-group">
                        <label class="settings-label">
                            <i class="fas fa-cut" aria-hidden="true"></i> ÉTAT DE LA TONTE
                        </label>
                        <div class="radio-group">
                            <div class="radio-option" id="settings-tondu-oui-option">
                                <input type="radio" id="settings-tondu-oui" name="settings-tondu" value="oui" checked>
                                <label for="settings-tondu-oui">TONDU</label>
                            </div>
                            <div class="radio-option" id="settings-tondu-non-option">
                                <input type="radio" id="settings-tondu-non" name="settings-tondu" value="non">
                                <label for="settings-tondu-non">NON TONDU</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="settings-group">
                        <label class="settings-label" for="settings-owner-name">
                            <i class="fas fa-user" aria-hidden="true"></i> NOM DU PROPRIÉTAIRE
                        </label>
                        <div class="input-with-icon">
                            <i class="fas fa-pencil-alt" aria-hidden="true"></i>
                            <input type="text" id="settings-owner-name" placeholder="Ex: Stéphanie" value="Stéphanie">
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-settings">
                        <i class="fas fa-save" aria-hidden="true"></i> ENREGISTRER LES PARAMÈTRES
                    </button>
                </form>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p><i class="fas fa-heart" style="color: var(--netflix-red);" aria-hidden="true"></i> POUR <span id="horse-name-6">ALDO</span> – <span id="owner-name-2">STÉPHANIE</span></p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Éléments DOM
            const temperatureInput = document.getElementById('temperature');
            const openGuideBtn = document.getElementById('open-guide');
            const openSettingsBtn = document.getElementById('open-settings');
            const closeResultBtn = document.getElementById('close-result');
            const closeGuideBtn = document.getElementById('close-guide');
            const closeSettingsBtn = document.getElementById('close-settings');
            const resultModal = document.getElementById('result-modal');
            const guideModal = document.getElementById('guide-modal');
            const settingsModal = document.getElementById('settings-modal');
            const resultModalBody = document.getElementById('result-modal-body');
            const settingsForm = document.getElementById('settings-form');
            const tonteIndicatorModal = document.getElementById('tonte-indicator-modal');
            const errorMessage = document.getElementById('temperature-help');
            const historyList = document.getElementById('history-list');
            const clearHistoryBtn = document.getElementById('clear-history');
            const toggleHistoryBtn = document.getElementById('toggle-history');
            
            // Éléments pour les noms personnalisés
            const horseNameElements = [
                document.getElementById('horse-name'),
                document.getElementById('horse-name-3'),
                document.getElementById('horse-name-4'),
                document.getElementById('horse-name-5'),
                document.getElementById('horse-name-6')
            ];
            const ownerNameElements = [
                document.getElementById('owner-name'),
                document.getElementById('owner-name-2')
            ];
            
            // Paramètres des règles
            const rulesTondu = [
                { min: 10, max: 15, recommendation: "Chemise d'écurie", details: "Une simple chemise d'écurie suffit.", type: "light" },
                { min: 5, max: 10, recommendation: "Polaire ou couverture (100–150 gr)", details: "Utilisez une polaire ou une couverture d'écurie.", type: "light" },
                { min: 0, max: 5, recommendation: "Couverture mi-saison (200 gr)", details: "Utilisez une couverture d'extérieur ou d'écurie.", type: "medium" },
                { min: -5, max: 0, recommendation: "Couverture chaude (300 gr)", details: "Utilisez une couverture d'extérieur ou d'écurie.", type: "heavy" },
                { min: -10, max: -5, recommendation: "Couverture épaisse (400 gr)", details: "Utilisez une couverture d'extérieur ou d'écurie.", type: "heavy" }
            ];

            const rulesNonTondu = [
                { min: 10, max: 15, recommendation: "Pas de couverture", details: "Aucune couverture n'est nécessaire.", type: "none" },
                { min: 5, max: 10, recommendation: "Polaire ou couverture", details: "Utilisez une polaire ou une couverture d'écurie.", type: "light" },
                { min: 0, max: 5, recommendation: "Polaire (100 gr)", details: "Utilisez une polaire ou une couverture d'écurie.", type: "light" },
                { min: -5, max: 0, recommendation: "Couverture mi-saison (200 gr)", details: "Utilisez une couverture d'extérieur ou d'écurie.", type: "medium" },
                { min: -10, max: -5, recommendation: "Couverture épaisse (300 gr)", details: "Utilisez une couverture d'extérieur ou d'écurie.", type: "heavy" }
            ];

            // Variables d'état
            let isTondu = true;
            let lastFocusedElement = null;
            let isHistoryCollapsed = false;
            let lastSavedEntry = null; // Pour éviter les doublons

            // Initialisation des paramètres
            function initializeSettings() {
                const savedHorseName = localStorage.getItem('horseName');
                const savedOwnerName = localStorage.getItem('ownerName');
                const savedIsTondu = localStorage.getItem('isTondu');
                
                if (savedHorseName) {
                    document.getElementById('settings-horse-name').value = savedHorseName;
                    updateHorseName(savedHorseName);
                }
                
                if (savedOwnerName) {
                    document.getElementById('settings-owner-name').value = savedOwnerName;
                    updateOwnerName(savedOwnerName);
                }
                
                if (savedIsTondu) {
                    isTondu = savedIsTondu === 'true';
                    document.getElementById('settings-tondu-oui').checked = isTondu;
                    document.getElementById('settings-tondu-non').checked = !isTondu;
                    updateTonteIndicator();
                }
                
                // Charger l'historique
                loadHistory();
            }
            
            // Mise à jour du nom du cheval
            function updateHorseName(name) {
                horseNameElements.forEach(element => {
                    if (element) element.textContent = name.toUpperCase();
                });
            }
            
            // Mise à jour du nom du propriétaire
            function updateOwnerName(name) {
                ownerNameElements.forEach(element => {
                    if (element) element.textContent = name.toUpperCase();
                });
            }
            
            // Mise à jour de l'indicateur de tonte
            function updateTonteIndicator() {
                if (isTondu) {
                    tonteIndicatorModal.innerHTML = '<i class="fas fa-cut" aria-hidden="true"></i> TONDU';
                    tonteIndicatorModal.className = 'tonte-indicator tondu';
                } else {
                    tonteIndicatorModal.innerHTML = '<i class="fas fa-wind" aria-hidden="true"></i> NON TONDU';
                    tonteIndicatorModal.className = 'tonte-indicator non-tondu';
                }
            }

            // Validation de la température
            function validateTemperature(temp) {
                return !isNaN(temp) && temp >= -20 && temp <= 30;
            }

            // Vérifier si une entrée similaire existe déjà (pour éviter les doublons)
            function isDuplicateEntry(temp, recommendation, type) {
                const history = getHistory();
                const now = new Date();
                const fiveMinutesAgo = new Date(now.getTime() - 5 * 60 * 1000); // 5 minutes
                
                return history.some(entry => {
                    const entryDate = new Date(entry.date);
                    return entry.temperature === temp && 
                           entry.recommendation === recommendation && 
                           entry.type === type &&
                           entryDate > fiveMinutesAgo; // Seulement vérifier les 5 dernières minutes
                });
            }

            // Sauvegarder automatiquement une recommandation dans l'historique (sans doublons)
            function saveToHistory(temp, recommendation, details, type) {
                // Vérifier si cette entrée existe déjà récemment
                if (isDuplicateEntry(temp, recommendation, type)) {
                    console.log('Entrée dupliquée détectée, non sauvegardée');
                    return;
                }
                
                const history = getHistory();
                const newEntry = {
                    id: Date.now(),
                    date: new Date().toISOString(),
                    temperature: temp,
                    recommendation: recommendation,
                    details: details,
                    type: type,
                    horseName: horseNameElements[0].textContent,
                    isTondu: isTondu
                };
                
                history.unshift(newEntry);
                
                // Garder seulement les 20 dernières entrées
                if (history.length > 20) {
                    history.splice(20);
                }
                
                localStorage.setItem('blanketHistory', JSON.stringify(history));
                loadHistory();
                
                // Mémoriser la dernière entrée sauvegardée
                lastSavedEntry = newEntry;
            }

            // Obtenir l'historique depuis le localStorage
            function getHistory() {
                const history = localStorage.getItem('blanketHistory');
                return history ? JSON.parse(history) : [];
            }

            // Charger l'historique dans l'interface
            function loadHistory() {
                const history = getHistory();
                
                if (history.length === 0) {
                    historyList.innerHTML = `
                        <div class="empty-history">
                            <i class="fas fa-history"></i>
                            <p>AUCUNE RECOMMANDATION ENCORE</p>
                            <p style="font-size: 0.9rem; margin-top: 1rem;">L'HISTORIQUE APPARAÎTRA AUTOMATIQUEMENT ICI</p>
                        </div>
                    `;
                    return;
                }
                
                historyList.innerHTML = history.map(entry => `
                    <div class="history-item">
                        <div class="history-date">${formatDate(entry.date)}</div>
                        <div class="history-temp">${Math.round(entry.temperature)}°C</div>
                        <div class="history-rec ${entry.type}-blanket">${entry.recommendation}</div>
                        <button class="history-delete" onclick="deleteHistoryEntry(${entry.id})" aria-label="Supprimer cette entrée">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `).join('');
            }

            // Formater la date
            function formatDate(dateString) {
                const date = new Date(dateString);
                const today = new Date();
                const yesterday = new Date(today);
                yesterday.setDate(yesterday.getDate() - 1);
                
                if (date.toDateString() === today.toDateString()) {
                    return "AUJOURD'HUI";
                } else if (date.toDateString() === yesterday.toDateString()) {
                    return "HIER";
                } else {
                    return date.toLocaleDateString('fr-FR', { 
                        day: 'numeric', 
                        month: 'short' 
                    }).toUpperCase();
                }
            }

            // Supprimer une entrée d'historique
            window.deleteHistoryEntry = function(id) {
                const history = getHistory();
                const updatedHistory = history.filter(entry => entry.id !== id);
                localStorage.setItem('blanketHistory', JSON.stringify(updatedHistory));
                loadHistory();
            };

            // Effacer tout l'historique
            function clearHistory() {
                if (confirm("VOULEZ-VOUS VRAIMENT EFFACER TOUT L'HISTORIQUE ?")) {
                    localStorage.removeItem('blanketHistory');
                    loadHistory();
                }
            }

            // Basculer l'affichage de l'historique
            function toggleHistory() {
                const historyContainer = document.querySelector('.history-list');
                const toggleIcon = toggleHistoryBtn.querySelector('i');
                
                isHistoryCollapsed = !isHistoryCollapsed;
                
                if (isHistoryCollapsed) {
                    historyContainer.style.maxHeight = '0';
                    historyContainer.style.overflow = 'hidden';
                    toggleIcon.className = 'fas fa-chevron-up';
                } else {
                    historyContainer.style.maxHeight = '300px';
                    historyContainer.style.overflow = 'auto';
                    toggleIcon.className = 'fas fa-chevron-down';
                }
            }

            // Calcul de la recommandation
            function calculateRecommendation() {
                const temp = parseFloat(temperatureInput.value);
                const isValid = validateTemperature(temp);
                
                // Gestion des erreurs
                if (!isValid && temperatureInput.value !== '') {
                    errorMessage.style.display = 'flex';
                    temperatureInput.style.borderColor = 'var(--netflix-red)';
                    if (resultModal.classList.contains('active')) {
                        resultModal.classList.remove('active');
                    }
                    return;
                } else {
                    errorMessage.style.display = 'none';
                    temperatureInput.style.borderColor = 'var(--netflix-gray)';
                }

                if (!isValid) {
                    if (resultModal.classList.contains('active')) {
                        resultModal.classList.remove('active');
                    }
                    return;
                }

                const rules = isTondu ? rulesTondu : rulesNonTondu;
                let rec = null;
                for (const rule of rules) {
                    if (temp >= rule.min && temp <= rule.max) {
                        rec = rule;
                        break;
                    }
                }

                let icon = "fas fa-horse", colorClass = "";
                if (rec) {
                    switch (rec.type) {
                        case "none": icon = "fas fa-check-circle"; colorClass = "no-blanket"; break;
                        case "light": colorClass = "light-blanket"; break;
                        case "medium": icon = "fas fa-horse-head"; colorClass = "medium-blanket"; break;
                        case "heavy": icon = "fas fa-horse-head"; colorClass = "heavy-blanket"; break;
                    }

                    // Sauvegarder automatiquement dans l'historique (sans doublons)
                    saveToHistory(temp, rec.recommendation, rec.details, rec.type);

                    resultModalBody.innerHTML = `
                        <div class="temperature-display">${Math.round(temp)}°C</div>
                        <div class="recommendation ${colorClass}"><i class="${icon}" aria-hidden="true"></i> ${rec.recommendation.toUpperCase()}</div>
                        <div class="details">${rec.details}</div>
                        <div class="info">
                            <i class="fas fa-info-circle" aria-hidden="true"></i> 
                            RECOMMANDATION POUR ${horseNameElements[0].textContent} (${isTondu ? 'TONDU' : 'NON TONDU'})
                        </div>
                    `;
                    
                    openModal(resultModal);
                } else {
                    resultModalBody.innerHTML = `
                        <div class="temperature-display">${Math.round(temp)}°C</div>
                        <div class="recommendation">TEMPORATURE HORS PLAGE</div>
                        <div class="details">La température n'est pas couverte par nos recommandations.</div>
                        <div class="info"><i class="fas fa-info-circle" aria-hidden="true"></i> OUVREZ LE GUIDE POUR PLUS DE DÉTAILS.</div>
                    `;
                    openModal(resultModal);
                }
            }

            // Gestion de l'ouverture des modales
            function openModal(modal) {
                lastFocusedElement = document.activeElement;
                modal.setAttribute('aria-hidden', 'false');
                modal.classList.add('active');
                
                // Focus sur le bouton de fermeture pour l'accessibilité
                const closeBtn = modal.querySelector('.close-modal');
                if (closeBtn) closeBtn.focus();
            }

            function closeModal(modal) {
                modal.setAttribute('aria-hidden', 'true');
                modal.classList.remove('active');
                
                // Retour au dernier élément focus pour l'accessibilité
                if (lastFocusedElement) lastFocusedElement.focus();
            }

            // Événements d'entrée de température - UNIQUEMENT sur change pour éviter les doublons
            temperatureInput.addEventListener('change', calculateRecommendation);

            // Gestion du formulaire de paramètres
            settingsForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const horseName = document.getElementById('settings-horse-name').value;
                const ownerName = document.getElementById('settings-owner-name').value;
                isTondu = document.getElementById('settings-tondu-oui').checked;
                
                // Sauvegarde dans le localStorage
                localStorage.setItem('horseName', horseName);
                localStorage.setItem('ownerName', ownerName);
                localStorage.setItem('isTondu', isTondu);
                
                // Mise à jour de l'interface
                updateHorseName(horseName);
                updateOwnerName(ownerName);
                updateTonteIndicator();
                
                // Fermeture de la modale
                closeModal(settingsModal);
            });

            // Ouverture des modales
            openGuideBtn.addEventListener('click', () => {
                openModal(guideModal);
            });

            openSettingsBtn.addEventListener('click', () => {
                openModal(settingsModal);
            });

            // Fermeture des modales
            closeResultBtn.addEventListener('click', () => {
                closeModal(resultModal);
            });

            closeGuideBtn.addEventListener('click', () => {
                closeModal(guideModal);
            });

            closeSettingsBtn.addEventListener('click', () => {
                closeModal(settingsModal);
            });

            // Gestion de l'historique
            clearHistoryBtn.addEventListener('click', clearHistory);
            toggleHistoryBtn.addEventListener('click', toggleHistory);

            // Fermeture des modales en cliquant à l'extérieur
            resultModal.addEventListener('click', (e) => {
                if (e.target === resultModal) closeModal(resultModal);
            });

            guideModal.addEventListener('click', (e) => {
                if (e.target === guideModal) closeModal(guideModal);
            });

            settingsModal.addEventListener('click', (e) => {
                if (e.target === settingsModal) closeModal(settingsModal);
            });

            // Fermeture des modales avec la touche Échap
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeModal(resultModal);
                    closeModal(guideModal);
                    closeModal(settingsModal);
                }
            });

            // Gestion de la navigation au clavier dans les modales
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Tab' && document.querySelector('.modal-overlay.active')) {
                    const modal = document.querySelector('.modal-overlay.active');
                    const focusableElements = modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                    const firstElement = focusableElements[0];
                    const lastElement = focusableElements[focusableElements.length - 1];
                    
                    if (e.shiftKey) {
                        if (document.activeElement === firstElement) {
                            e.preventDefault();
                            lastElement.focus();
                        }
                    } else {
                        if (document.activeElement === lastElement) {
                            e.preventDefault();
                            firstElement.focus();
                        }
                    }
                }
            });

            // Initialisation
            initializeSettings();
            updateTonteIndicator();
        });
    </script>
</body>
</html>